---
layout: activity-help

title: Implémentation sur Blockly de la méthode des K plus proche voisins
introduction : >
    <p>
        Maintenant que nous avons une bonne compréhension et intuition de l’algorithme des K plus proche voisins nous allons le mettre en pratique à l’aide de Blockly.
    </p>
previewPicture : /static/img/KNN/activityPreview.png
youtubeVideo : Nybu_OiZHhQ

toolbarActivityName : KNN
toolboxButtonDescription :
- Commencer un nouveau projet, cela effacera tous les blocs.
- Sauvegarder/télécharger ton projet sur ton ordinateur (uniquement les blocs de Blockly).<br>Les paramètres ne sont pas enregistrés
- Ouvrir un projet précédemment sauvegardé.<br>Uniquement les blocs Blockly sont chargés
- Exporte le projet (blocs) sous forme d’images (SVG (vectoriel) ou PNG ).<br>Attention que si tu exportes en image tu ne peux pas l’ouvrir comme projet
- Voir le code JavaScript généré par Blockly dans une fenêtre pop-up
- Tester le code. Se contentera d’exécutera le code du projet tel quel.
- Tester le classifieur. Lance le programme en évaluant si les prédictions sont correctes.<br>Cela te permettra de réussir ton objectif !
- Renvoie vers la page d'aide (celle-çi)
- Te permet de choisir la langue.<br>Seulement le français et l’anglais sont pleinement compatible. Les autres changeront uniquement le texte des blocs de Blockly.

leftPartName : Données et Paramètres
leftPartDesc : La partie de gauche te permet d'observer les données ainsi que de modifier les paramètres de l'algorithme.
leftPartSections:
-   title: Panneau Graphe et Données
    picture: /static/img/KNN/site-graphAndDatas.png
    description: >
        Te permet de consulter et visualiser les données du training set.
        Chaque point du graphe correspond à une fleur du training set.
        Sa forme et couleur définit sa classe comme légendé en dessous du graphe.<br>
        Tu peux survoler avec ta souris un point pour obtenir des informations le concernant.<br>
        Tu pourra également ajouter des fleurs "artificielle" dans le graphe via Blockly.
        Pour effacer ses derniers tu pourra utiliser le bouton jaune avec la gomme<br>
-   title: Panneau paramètres
    picture: /static/img/KNN/site-parameters.png
    description: >
        Te permet de modifier le comportement de l'algorithme des K plus proches voisins.<br>
        La modification des axes mettra également à jour le graphe du training set selon le choix.

rightPartName : Blockly
rightPartDesc : La partie de droite est l'emplacement ou tu pourra modifier le code de l'algorithme afin de réussir l'objectif.
rightPartContentBlockly :
-   blockName: getK
    desc: Donne la valeur de K définie dans le Panneau Paramètres
    returnType: Nombre
-   blockName: countersReset
    desc: Permet de réinitialiser le compteur de chaque fleur à zéro
-   blockName: countersIncrease
    desc: Ajoute la valeur donné à la classe de la i-ème fleur la plus proche.
-   blockName: countersGetMinMax
    desc: Récupère la fleur associée au compteur avec la valeur minimale/maximale
    returnType: Texte (nom de fleur)
-   blockName: getCounters
    desc: Permet de consulter la valeur des compteurs.<br>Ce bloc est utile seulement pour débugger afin de pouvoir voir les valeurs des compteurs
    returnType: Texte
-   blockName: createFlower
    desc: Permet de créer une fleur artificielle qui aura les valeurs données en <code>x</code> et <code>y</code> (dépend de ce que tu as fixer comme paramètres).<br>Voir exemples ci-dessous
    returnType: Fleur

examples:
-   title: Créer une fleur artificielle
    content : >
        <p>
            Pour tester ton programme, il peut être utile de créer des fleurs "artificielles".
            Ce sont des fleurs qui apparaîtront sur le graphe, mais qui ne sont pas dans le training set.<br>
        </p>
        <p>
            Pour cela on va d'abord créer une fleur avec le bloc supplémentaire en spécifiant les coordonnées <code>x</code> et <code>y</code> désirés.
        </p>
        <div class="mx-auto" align="center">
            <img src="/static/img/blocklyBlocks/createFlower.svg" class="img-fluid">
        </div>
        <p>
            Après cela il faut qu'on exécute le code pour mettre à jour le graphe via le bouton
            <button class="btn btn-primary"><i class="fas fa-play"></i></button><br>
            Une croix cyan apparaitra comme marqueur de ta/tes fleur(s) ajouté.
        </p>
        <div class="card">
            <div class="card-body">
                <p>
                    Attention que le graphique se mettra à jour selon les paramètres que tu as choisis pour l’axe x et y dans le panneau des paramètres.<br>
                </p>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm">
                            <img src="/static/img/KNN/addFlowerPar1.PNG" class="img-fluid float-left">
                        </div>
                        <div class="col-sm">
                            <img src="/static/img/KNN/addFlowerPar2.PNG" class="img-fluid float-right">
                        </div>
                    </div>
                </div>
                <small class="text-muted"><br>Ici la même fleur est ajoutée (au coordonnées (6.1, 1.7)), mais les axes sont différents</small>
            </div>
        </div>
-   title : Manipuler une fleur artificielle
    content : >
        <p>
            Les fleurs que tu créés artificiellement sont considérées comme des fleurs "classiques" dans le code.
            Tu peux les utiliser avec tous les autres blocs utilisant des fleurs.
        </p>
        <p>
            Voici un exemple un peu complexe d'utilisation possible:
        </p>
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/exampleBlockAppCompteur2.svg" class="img-fluid"><br>
        </div>
        <br>
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/exampleBlockAppCompteurRes2.PNG" class="img-fluid">
        </div>
        <small class="text-muted">
            Dans cet exemple, on ajoute une fleur artificielle en (4.9, 4.2) avec comme axe x le sepal length et y le petal length.<br>
            On commence par réinitialiser les compteurs des 3 fleurs en les mettant à zéro<br>
            Ensuite, on ajoute au compteur de la fleur la plus proche la valeur -10. Dans notre cas, la fleur la plus proche est un carré vert (virginica), son compteur étant de 0, il passe à -10.<br>
            Après cela, on ajoute au compteur de la 2ème fleur la plus proche la valeur 20. Dans notre cas, la 2ème fleur la plus proche est un triangle rouge (versicolor), son compteur étant de 0, il passe à 20.<br>
            Enfin, on affiche la valeur des compteurs :
            <ul>
                <li>0 pour les Iris-setosa</li>
                <li>20 pour les Iris-versicolor</li>
                <li>-10 pour les Iris-virginica</li>
            </ul>
            Attention que <code>K</code> est totalement ignoré dans cet exemple, il faudra le prendre en compte quand tu devras résoudre le problème ;)
        </small>
        <br>
        <br>
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/exampleBlockAppCompteur.svg" class="img-fluid"><br>
        </div>
        <br>
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/exampleBlockAppCompteurRes.PNG" class="img-fluid">
        </div>
        <small class="text-muted">
            Pareil que l'exemple précédent, sauf qu'au lieu d'afficher les valeurs des compteurs on indique les fleurs avec les valeurs de compteur minimale et maximale
        </small>

goalDescription : >
    <p>
        Ton but sera de définir la fonction <code>classify(newIris)</code>.
        Cette fonction prend une fleur en argument <code>newIris</code> et renvoie le nom prédit de cette fleur.
    </p>
    <div class="mx-auto" align="center">
        <img src="/static/img/KNN/classifyFunction.svg" class="img-fluid">
    </div>
    <p>
        La qualité de ton classifieur est représentée par la barre de progression bleu en dessous de la barre d'outil.<br>
        Cette barre se met à jour à chaque fois que tu teste ton classifieur en testant ta fonction de classification <code>classify</code>.<br>
        Ton objectif final est d'atteindre la meilleure prédiction possible (100%)
    </p>
    <div class="mt-2 col-md-12">
        <h6 style="float: left; margin-right: 1em;"> Prédiction courante : </h6>
        <div class="progress" style="height: 32px;">
            <div id="predictionProgressBar" class="progress-bar bg-success progress-bar-striped progress-bar-animated" role="progressbar" style="width: 100%;">100.00%</div>
        </div>
    </div>

    <p>
        Pour cela, il faut que tu modifies cette fonction de manière qu’elle implémente le concept vu de l’algorithme des K plus proches voisins.
        En plus de cela tu as différent paramètres que tu peux faire varier,
        tu devras trouver la combinaison qui te donnera la meilleure prédiction.
    </p>

    <h3>Implémentation</h3>
    <p>
        L’algorithme peut être séparé en plusieurs étapes distinctes qui, petit à petit, te rapprocheront de la solution.
        Je vais t’aider dans cette partie à atteindre la bonne solution en te donnant les intuitions.<br>
        Libre à toi de faire autrement si tu le souhaites tant que la prédiction finale est bonne.
    </p>

goalSteps :
-   title: Bien commencer !
    content: >
        <p>
            Dans la section <code>TODO</code> de la boite à outil de blockly tu trouvera une première implémentation de la fonction que tu dois faire.<br>
            Commence par la prendre et test le résultat de ton prédicteur avec.
        </p>
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/classifyFunctionDefault.svg" class="img-fluid">
        </div>

        <p>
            Normalement tu devrais avoir un résultat d’environ 33% et chaque fois que tu re-test le prédicteur,
            il donnera un résultat différent.<br>
            C’est normal car le prédicteur que je te donne ici est totalement aléatoire et se contente de donner un nom parmi ceux disponible de manière aléatoire.
            Autrement dit, pour chaque fleur il a 1 chance sur 3 de deviner correctement (d’ou les 33%).
        </p>

        <div class="mt-2 col-md-12">
            <h6 style="float: left; margin-right: 1em;"> Prédiction courante : </h6>
            <div class="progress" style="height: 32px;">
                <div class="progress-bar bg-danger progress-bar-striped progress-bar-animated" role="progressbar" style="width: 33%;">33.33%</div>
            </div>
        </div>
-   title: implémenter les K plus proches voisins
    content: >
        <p>
            Pour réaliser à bien ce projet il est important que tu comprenne bien comment utiliser les compteurs et à quoi ils vont nous servir.<br><br>
            L'idée générale est d'augmenter le compteur de chacune des K fleurs les plus proches pour ensuite déterminer celle qui est en majorité
        </p>

        <p>
            Voilà différents exemple pour t'entrainer et voir si tes résultats sont correctes :
        </p>
        <small class="text-muted">
            Le code principal de l'algorithme est ici caché ici dans la fonction <code>code...</code>, mait tu n'es bien-entendu pas obliger d'implémenter une fonction pour ça ;)<br>
            Tu peux recopier la partie du code avec <code>afficher...</code> si tu veux avoir le même affichage que moi (en supposant que tes compteurs se mettent correctement à jour)<br>
            Fais bien attention que les paramètres et les coordonnées de la fleur créé changent entre chacun des exemples !
        </small>

        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/stepMainEx1.PNG" class="img-fluid">
            <br>
            <img src="/static/img/KNN/stepMainEx2.PNG" class="img-fluid">
            <br>
            <img src="/static/img/KNN/stepMainEx3.PNG" class="img-fluid">
        </div>
    recommandedBlocks: countersReset countersIncrease countersGetMinMax getK forI
    help: >
        Une structure correcte du code est la suivante :
        <ol>
            <li>Réinitialiser le compteur, chacune des trois fleurs à un compteur qui est mis à 0</li>
            <li>Pour chacune des K fleurs les plus proches, il faudra augmenter leur compteur individuel de 1</li>
            <li>Une fois les K fleurs parcouru, il suffit de choisir celle qui à la valeur de compteur la plus haute et mettre à jour le résultat renvoyé</li>
        </ol>
    correction: >
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/solutionKNN.svg" class="img-fluid">
        </div>
-   title: Obtenir 100%
    content: >
        <p>
            Une fois que ton implémentation te parait correxte, il ne te reste plus qu’à faire un peu le tri dans ton code !
            Enlève tout les <code>afficher ...</code> qui seront gênant quand tu évaluera ton prédicteur,
            choisis bien tes paramètres (K, Axe x et Axe y) et croise les doigts pour atteindre les 100% !
        </p>
    correction: >
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/solutionKNN.svg" class="img-fluid">
        </div>
        Avec par exemple comme paramètres :
        <div class="mx-auto" align="center">
            <img src="/static/img/KNN/solParametersKNN.png" class="img-fluid">
        </div>
---
